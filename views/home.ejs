<script src="https://code.highcharts.com/highcharts.js"></script>
<div class="container-fluid py-4">
  <div class="row mt-4">
    <div class="col-lg-12 mb-lg-0 mb-4">
      <div class="card z-index-2 h-100">
        <div class="card-header pb-0 pt-3 bg-transparent">
        </div>
        <div class="card-body p-3">
          <div id="moistureChart"></div>
        </div>
      </div>
    </div>
  </div>

    <div class="row mt-4">
      <div class="col-lg-12 mb-lg-0 mb-4">
        <div class="card z-index-2 h-100">
          <div class="card-header pb-0 pt-3 bg-transparent">
          </div>
          <div class="card-body p-3">
            <div id="humidityChart"></div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row mt-4">
      <div class="col-lg-12 mb-lg-0 mb-4">
        <div class="card z-index-2 h-100">
          <div class="card-header pb-0 pt-3 bg-transparent">
          </div>
          <div class="card-body p-3">
            <div id="lightChart"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-4">
      <div class="col-lg-12 mb-lg-0 mb-4">
        <div class="card z-index-2 h-100">
          <div class="card-header pb-0 pt-3 bg-transparent">
          </div>
          <div class="card-body p-3">
            <div id="temperatureChart"></div>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer pt-3  ">
      <div class="container-fluid">
        <div class="row align-items-center justify-content-lg-between">
          <div class="col-lg-6 mb-lg-0 mb-4">
            <div class="copyright text-center text-sm text-muted text-lg-start">
              Â© <script>
                document.write(new Date().getFullYear())
              </script>,
              made with <i class="fa fa-heart"></i> by
              <a href="https://www.creative-tim.com" class="font-weight-bold" target="_blank">Creative Tim</a>
              for a better web.
            </div>
          </div>
          <div class="col-lg-6">
            <ul class="nav nav-footer justify-content-center justify-content-lg-end">
              <li class="nav-item">
                <a href="https://www.creative-tim.com" class="nav-link text-muted" target="_blank">Creative Tim</a>
              </li>
              <li class="nav-item">
                <a href="https://www.creative-tim.com/presentation" class="nav-link text-muted" target="_blank">About Us</a>
              </li>
              <li class="nav-item">
                <a href="https://www.creative-tim.com/blog" class="nav-link text-muted" target="_blank">Blog</a>
              </li>
              <li class="nav-item">
                <a href="https://www.creative-tim.com/license" class="nav-link pe-0 text-muted" target="_blank">License</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
  fetch('/moisture').then(response => response.json()).then(data => {
      // Format the data for Highcharts
      const formattedData = data.map(item => ({
        name: item.dateTime,
        y: item.moisture,
      }));

      console.log(formattedData)
      // Render the chart
      Highcharts.chart('moistureChart', {
        chart: {
          type: 'column',
        },
        title: {
          text: 'Plant Moisture Data',
        },
        series: [
          {
            data: formattedData,
          },
        ],
      });
    }).catch(error => console.error('Error:', error));

    fetch('/humidity').then(response => response.json()).then(data => {
      // Format the data for Highcharts
      const formattedData = data.map(item => ({
        name: item.dateTime,
        y: item.humidity,
      }));

      console.log(formattedData)
      // Render the chart
      Highcharts.chart('humidityChart', {
        chart: {
          type: 'column',
        },
        title: {
          text: 'Plant Humadity Data',
        },
        series: [
          {
            data: formattedData,
          },
        ],
      });
    }).catch(error => console.error('Error:', error));

    fetch('/temperature').then(response => response.json()).then(data => {
      // Format the data for Highcharts
      const formattedData = data.map(item => ({
        name: item.dateTime,
        y: item.temperature,
      }));

      console.log(formattedData)
      // Render the chart
      Highcharts.chart('temperatureChart', {
        chart: {
          type: 'column',
        },
        title: {
          text: 'Plant Temperature Data',
        },
        series: [
          {
            data: formattedData,
          },
        ],
      });
    }).catch(error => console.error('Error:', error));

    fetch('/light').then(response => response.json()).then(data => {
      // Format the data for Highcharts
      const formattedData = data.map(item => ({
        name: item.dateTime,
        y: item.light,
      }));

      console.log(formattedData)
      // Render the chart
      Highcharts.chart('lightChart', {
        chart: {
          type: 'column',
        },
        title: {
          text: 'Plant Light Data',
        },
        series: [
          {
            data: formattedData,
          },
        ],
      });
    }).catch(error => console.error('Error:', error));
});
  </script>